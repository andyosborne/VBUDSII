% plotxsbys0


mycd = cd;
cd(fullfile('..','dataprocessing',''));
vbudsiiDir = cd;
cd(mycd); % alternatively, mfilename

%% DEFINE PARAMETER STRUCTURE
fineGroupDef = 10.^(-4:.1:7);
fewGroupDef = [1e-4 1 100e3 1e7];
p = struct('nFineGroups',length(fineGroupDef)-1,... % leave blank.
           'nFewGroups',length(fewGroupDef)-1,...
           'fineGroupDef',fineGroupDef,...
           'fewGroupDef',fewGroupDef,...
           'temp',600,...
           'powerDensity',50,... % MW/m^3
           'nTimeSteps',1,...
           'vbudsiiDir',vbudsiiDir,...
           'makeLibrary',1,...
           'makeLibraryTempFlag',2,...
           'XSLibraryMAT',fullfile('..','..','data','XSLibrary.mat'),...
           'verbose',1,...
           'resolveXS',0,...
           'immutableMyMTs',0,...
           'S0iterthresh',.00001); % this largely affects the validation effort.

L = MakeLibrary(p);

%{
for z = L.ZAIDs
    for m = L.MTs
        for t = L.Ts
            if (m ~= 2) && ...
                    ( sum(abs(L.z(L.ZAID(z)).m(L.MT(m)).xs(:,L.T(t),1) ...
                     -L.z(L.ZAID(z)).m(L.MT(m)).xs(:,L.T(t),end))) > 0 )
                 fprintf('ZAID %d   MT %d    T%d \n',z,m,t)    
            end
        end
    end
end
%}
    
plotxsn(0,0,'ZAID 92235 MT 18 T 600',{'-1','0','1','2','3','5','10'},'',...
        p.fineGroupDef,...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(-1)),...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(0)),...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(1)),...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(2)),...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(3)),...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(5)),...
        L.z(L.ZAID(92235)).m(L.MT(18)).xs(:,L.T(600),L.S0(10)));
    
plotxsn(0,0,'ZAID 92235 MT 102 T 600',{'-1','0','1','2','3','5','10'},'',...
        p.fineGroupDef,...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1)),...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(0)),...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(1)),...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(2)),...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(3)),...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(5)),...
        L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(10)));

plotxsn(0,0,'ZAID 92235 MT 4 T 600',{'-1','0','1','2','3','5','10'},'',...
        p.fineGroupDef,...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(-1)),...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(0)),...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(1)),...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(2)),...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(3)),...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(5)),...
        L.z(L.ZAID(92235)).m(L.MT(4)).xs(:,L.T(600),L.S0(10)));
    
plotxsn(0,0,'ZAID 92238 MT 18 T 600',{'-1','0','1','2','3','5','10'},'',...
        p.fineGroupDef,...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(-1)),...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(0)),...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(1)),...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(2)),...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(3)),...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(5)),...
        L.z(L.ZAID(92238)).m(L.MT(18)).xs(:,L.T(600),L.S0(10)));
    
plotxsn(0,0,'ZAID 92238 MT 102 T 600',{'-1','0','1','2','3','5','10'},'',...
        p.fineGroupDef,...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1)),...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(0)),...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(1)),...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(2)),...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(3)),...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(5)),...
        L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(10)));

plotxsn(0,0,'ZAID 92238 MT 4 T 600',{'-1','0','1','2','3','5','10'},'',...
        p.fineGroupDef,...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(-1)),...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(0)),...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(1)),...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(2)),...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(3)),...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(5)),...
        L.z(L.ZAID(92238)).m(L.MT(4)).xs(:,L.T(600),L.S0(10)));


enrichment = .032;
density_H2O = 0.72; % g/cm^3
density_UO2 = 11; %g/cm^3
[ao, wo, N_H2O] = matl([1001 2;
                        8016 1], 1, density_H2O);
[ao, wo, N_UO2] = matl([92235 enrichment;
                        92238 1-enrichment;
                        8016 2], 1, density_UO2);

plotxsn(0,0,'Cell 2 MT 102 T 600',{'92238 -1','92238 10','92235 -1',...
        '92235 10','8016 -1','8016 10'},'',...
        p.fineGroupDef,...
        N_UO2(2)*L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1)),...
        N_UO2(2)*L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(10)),...
        N_UO2(1)*L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1)),...
        N_UO2(1)*L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(10)),...
        N_UO2(3)*L.z(L.ZAID(8016)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1)),...
        N_UO2(3)*L.z(L.ZAID(8016)).m(L.MT(102)).xs(:,L.T(600),L.S0(10)));

A1=   N_UO2(2)*L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1));
A2=   N_UO2(2)*L.z(L.ZAID(92238)).m(L.MT(102)).xs(:,L.T(600),L.S0(10));
B1=   N_UO2(1)*L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1));
B2=   N_UO2(1)*L.z(L.ZAID(92235)).m(L.MT(102)).xs(:,L.T(600),L.S0(10));
C1=   N_UO2(3)*L.z(L.ZAID(8016)).m(L.MT(102)).xs(:,L.T(600),L.S0(-1));
C2=   N_UO2(3)*L.z(L.ZAID(8016)).m(L.MT(102)).xs(:,L.T(600),L.S0(10));

plotxsn(0,0,'Cell 2 MT 102 T 600',{'92238 -1','92238 10','92235 -1',...
        '92235 10','8016 -1','8016 10','UO2 -1','UO2 10'},'',...
        p.fineGroupDef,...
        A1, A2, B1, B2, C1, C2,...
   A1+B1+C1,...
   A2 + B2 + C2);

plotxsn(0,0,'Cell 2 MT 102 T 600',{'UO2 -1','UO2 10'},'',...
        p.fineGroupDef,...
   A1+B1+C1,...
   A2 + B2 + C2);

